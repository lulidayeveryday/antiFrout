{"remainingRequest":"E:\\2020xian\\git-AntiFraud\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js??vue-loader-options!E:\\2020xian\\git-AntiFraud\\src\\views\\limits-authority\\role-management.vue?vue&type=style&index=0&id=5480ad5a&scoped=true&lang=css&","dependencies":[{"path":"E:\\2020xian\\git-AntiFraud\\src\\views\\limits-authority\\role-management.vue","mtime":1610331130593},{"path":"E:\\2020xian\\git-AntiFraud\\node_modules\\_css-loader@3.6.0@css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\2020xian\\git-AntiFraud\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\2020xian\\git-AntiFraud\\node_modules\\_postcss-loader@3.0.0@postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\2020xian\\git-AntiFraud\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\2020xian\\git-AntiFraud\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmVsLWZvcm0taXRlbXsKICBtYXJnaW4tYm90dG9tOiAxMHB4Owp9Ci5lbC10YWJsZSAuY2VsbHsKICB3aGl0ZS1zcGFjZTogbm93cmFwOwp9Cg=="},{"version":3,"sources":["role-management.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgVA;AACA;AACA;AACA;AACA;AACA","file":"role-management.vue","sourceRoot":"src/views/limits-authority","sourcesContent":["<template>\n  <el-container style=\"height: calc(100vh - 84px);padding: 20px;\">\n    <el-main>\n\n      <el-button type=\"warning\" icon=\"el-icon-plus\" @click=\"addRole = true\">新增角色</el-button>\n      <el-table\n        :key=\"tableKey\"\n        v-loading=\"listLoading\"\n        :data=\"list\"\n        border\n        fit\n        highlight-current-row\n        style=\"width: 100%;margin: 20px 0;\"\n        @sort-change=\"sortChange\"\n      >\n        <el-table-column label=\"名称\" align=\"center\" show-overflow-tooltip>\n          <template slot-scope=\"{row}\">\n            <span>{{ row.roleName}}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"描述\" align=\"center\" show-overflow-tooltip>\n          <template slot-scope=\"{row}\">\n            <span>{{ row.memo }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"创建时间\" min-width=\"162\" align=\"center\" show-overflow-tooltip>\n          <template slot-scope=\"{row}\">\n            <span>{{ row.createDate }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"权限\" align=\"center\" class-name=\"small-padding fixed-width\" show-overflow-tooltip>\n          <template slot-scope=\"{row}\">\n            <el-button type=\"primary\" size=\"mini\" @click=\"handleUpdate(row)\">\n              修改\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      <div class=\"block\">\n        <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"pageCurrent\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          :page-size=\"pageSize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"pageTotal\">\n        </el-pagination>\n      </div>\n\n      <el-dialog :title=\"'新增角色'\" :visible.sync=\"addRole\" >\n        <el-form ref=\"dataForm\" :model=\"temp\" label-position=\"left\" label-width=\"100px\"  style=\" margin-right:50px;margin-left:50px;\">\n\n          <el-form-item label=\"名称\">\n            <el-input\n              v-model=\"add.roleName\"\n              placeholder=\"请输入名称\"\n            >\n            </el-input>\n          </el-form-item>\n          <el-form-item label=\"描述\">\n            <el-input\n              v-model=\"add.memo\"\n              placeholder=\"请输入描述\"\n            >\n            </el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"addRole = false\">\n            关闭\n          </el-button>\n          <el-button type=\"primary\" @click=\"addRoles\">\n            新增\n          </el-button>\n        </div>\n      </el-dialog>\n    </el-main>\n    <el-aside v-if=\"treeShow\" width=\"350px\" v-loading=\"loading\">\n      <div>\n        菜单列表\n      </div>\n      <el-tree\n        class=\"filter-tree\"\n        v-loading=\"treeLoading\"\n        :data=\"data\"\n        node-key=\"id\"\n        :props=\"defaultProps\"\n        :expand-on-click-node=\"false\"\n        show-checkbox\n        :default-checked-keys=\"checkKeys\"\n        @check-change=\"handleCheckChange\"\n        ref=\"tree\">\n      </el-tree>\n      <div style=\"margin-top: 20px;\">\n        <el-button size=\"mini\" @click=\"treeShow = false\">\n          取消\n        </el-button>\n        <el-button size=\"mini\" type=\"primary\" @click=\"editRoleTree\">\n          保存\n        </el-button>\n      </div>\n    </el-aside>\n  </el-container>\n</template>\n\n<script>\n  import { fetchroleList,fetchaddRole,fetchtreeAllList,fetchtreeSelList,editTreeSelList } from '@/api/limits-authority';\n  import moment from 'moment';\n    export default {\n        name: \"role-management\",\n      data() {\n        return {\n          treeShow:false,\n          treeLoading:true,\n          checkKeys:[1,4,5,7],\n          data: [\n            {\n              id: 1,\n              label: '一级 1',\n              children: [{\n                id: 4,\n                label: '二级 1-1',\n                children: [{\n                  id: 9,\n                  label: '三级 1-1-1'\n                }, {\n                  id: 10,\n                  label: '三级 1-1-2'\n                }]\n              }]\n            }, {\n              id: 2,\n              label: '一级 2',\n              children: [{\n                id: 5,\n                label: '二级 2-1'\n              }, {\n                id: 6,\n                label: '二级 2-2'\n              }]\n            }, {\n              id: 3,\n              label: '一级 3',\n              children: [{\n                id: 7,\n                label: '二级 3-1'\n              }, {\n                id: 8,\n                label: '二级 3-2'\n              }]\n            }],\n          currentPage: 1,\n          list:[\n            {\n              test1:'实名专员(反欺诈)',\n              test2:'实名专员(反欺诈)',\n              test3:'2020/5/6 上午10:34:10'\n            }\n          ],\n          addRole: false,\n          defaultProps: {\n            children: 'children',\n            label: 'label'\n          },\n          pageSize:10,//每页显示条数\n          pageCurrent:1,//当前页\n          pageTotal:100,\n          loading: false,\n          add:{\n            roleName:'',\n            memo:'',\n            createDate:''\n          },\n          selRow:{}\n        }\n      },\n      created(){\n        /*替换*/\n        this.fetchList();\n        /*正式环境注销掉*/\n        /*let datas={\n          \"total\": 4,\n          \"data\": [{\n            \"auths\": [],\n            \"createDate\": \"2017-09-07\",\n            \"createPersion\": \"超级管理员\",\n            \"memo\": null,\n            \"ord\": null,\n            \"roleId\": \"2c90bfc35e5a45fc015e5a45fc870000\",\n            \"roleName\": \"省分管理员\",\n            \"updateDate\": \"2020-12-02\",\n            \"updatePersion\": \"2c90bfc35e27f4a2015e27f4a2b00000\"\n          }, {\n            \"auths\": [],\n            \"createDate\": \"2020-12-14\",\n            \"createPersion\": \"超级管理员\",\n            \"memo\": \"西安管理员\",\n            \"ord\": null,\n            \"roleId\": \"766091ca01766091caf30000\",\n            \"roleName\": \"西安管理员\",\n            \"updateDate\": null,\n            \"updatePersion\": null\n          }, {\n            \"auths\": [],\n            \"createDate\": \"2017-08-23\",\n            \"createPersion\": \"超级管理员\",\n            \"memo\": \"拥有所有权限\",\n            \"ord\": null,\n            \"roleId\": \"2c90bfc35e0ca664015e0ca6649d0000\",\n            \"roleName\": \"超级管理员\",\n            \"updateDate\": \"2020-09-21\",\n            \"updatePersion\": \"2c90bfc35e27f4a2015e27f4a2b00000\"\n          }, {\n            \"auths\": [],\n            \"createDate\": \"2019-05-24\",\n            \"createPersion\": \"超级管理员\",\n            \"memo\": null,\n            \"ord\": null,\n            \"roleId\": \"8a8ae4ed6ae801c9016ae801c9040000\",\n            \"roleName\": \"地市管理员\",\n            \"updateDate\": \"2020-12-14\",\n            \"updatePersion\": \"2c90bfc35e27f4a2015e27f4a2b00000\"\n          }]\n        }\n        this.list=datas.data;\n        this.pageTotal = datas.total;*/\n\n\n      },\n      watch:{\n        addRole(newdata,olddata){\n          if(newdata == false){\n            this.add.createDate='';\n            this.add.memo='';\n            this.add.roleName='';\n          }\n        }\n      },\n      methods: {\n        editRoleTree(){\n          let selLists = this.$refs.tree.getCheckedKeys();\n          let roleRow = this.selRow;\n          let param = {};\n          param.roleInfo = roleRow;\n          let selLista = {};\n          selLista.data = selLists;\n          param.selList = selLista\n          editTreeSelList(param).then(response => {\n            this.$message({\n              message: '修改成功',\n              type: 'success'\n            });\n            this.treeShow = false\n          }).catch(err => {\n            console.log(err)\n          })\n        },\n        addRoles(){\n          let param = this.add;\n          if(param.roleName===''){\n            this.$message({\n              message: '请填写名称',\n              type: 'warning'\n            });\n            return;\n          }else if(param.memo===''){\n            this.$message({\n              message: '请填写描述',\n              type: 'warning'\n            });\n            return;\n          };\n          let date = new Date();\n          param.createDate = moment(date).format('YYYY-MM-DD');\n          fetchaddRole(param).then(response => {\n            if(response.resultState==='1'){\n              this.$message({\n                message: '新增角色成功',\n                type: 'success'\n              });\n              this.fetchList()\n              this.addRole = false\n            }\n          }).catch(err => {\n            console.log(err)\n          })\n        },\n        fetchList(){\n          let param = {};\n          param.start = (this.pageCurrent-1)*this.pageSize;\n          param.length = this.pageSize;\n          fetchroleList(param).then(response => {\n            this.list = response.data\n            this.pageTotal = response.total;\n          }).catch(err => {\n            console.log(err)\n          })\n        },\n        handleUpdate(row){\n            this.treeShow = true;\n            var param=row;\n            this.selRow = row;\n            fetchtreeAllList().then(response => {\n              this.data = response;\n              fetchtreeSelList(param).then(response => {\n                let selList = [];\n                for(let a=0;a<response.length;a++){\n                  selList.push(response[a].id)\n                }\n                // this.checkKeys = selList;\n                this.treeLoading=false;\n                this.$refs.tree.setCheckedKeys(selList)\n              }).catch(err => {\n                console.log(err)\n              })\n            }).catch(err => {\n              console.log(err)\n            })\n          },\n        handleCheckChange(data, checked, indeterminate) {\n          console.log(data, checked, indeterminate);\n        },\n        handleSizeChange(val) {\n          this.pageSize=val;\n          this.fetchList();\n        },\n        handleCurrentChange(val) {\n          this.pageCurrent=val;\n          this.fetchList();\n        },\n      }\n    }\n</script>\n\n<style scoped>\n.el-form-item{\n  margin-bottom: 10px;\n}\n.el-table .cell{\n  white-space: nowrap;\n}\n</style>\n"]}]}